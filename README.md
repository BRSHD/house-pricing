# California Housing Prices

<img width="1902" height="887" alt="image" src="https://github.com/user-attachments/assets/f9794a83-4b20-45b5-bbdf-acd5f20ccece" />

Модель машинного обучения(Gradient Boosting), помогающая риелторам, инвесторам и банкам в оценке недвижимости в штате Калифорния. 
Проект включает визуализацию данных, обучение модели и создание веб-интерфейса с помощью FastAPI и Streamlit для взаимодействия c данными.

## Локальный запуск

1. Клонируйте репозиторий:

```bash
git clone https://github.com/BRSHD/housing-prices
cd housing-prices
```

2. Создайте виртуальное окружение для проекта с помощью `venv`:

```shell
python -m venv venv
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate.ps1  # Windows
```

3. Установите зависимости проекта:

```shell
pip install -r requirements.txt
```

4. Запустите сервис с помощью команды:

```shell
uvicorn service:app
```

После запуска FastAPI будет доступен по адресу: http://localhost:8000

Документация API: http://localhost:8000/docs


5. Выполните команду для показа веб-интерфейса:

```shell
streamlit run app.py
```

После запуска Streamlit будет доступен по адресу: http://localhost:8501


## Данные

Открытый датасет [**California Housing Prices**](https://www.kaggle.com/datasets/camnugent/california-housing-prices).  

Размер: 20640 строк

Признаки:
- ***longitude:*** показатель того, насколько далеко на запад находится дом: чем больше значение, тем дальше на запад

- ***latitude:*** показатель того, насколько далеко на север находится дом: чем больше значение, тем дальше на север

- ***housingMedianAge:*** средний возраст дома в квартале: меньшее число соответствует более новому зданию

- ***totalRooms:*** Общее количество комнат в квартале

- **totalBedrooms:** Общее количество спален в квартале

- ***population:*** Общее количество людей, проживающих в пределах квартала

- ***households:*** общее количество домохозяйств, группы людей, проживающих в пределах жилого помещения, для квартала

- ***medianIncome:*** средний доход домохозяйств в пределах жилого квартала (измеряется в десятках тысяч долларов США)

- ***oceanProximity:*** Расположение дома относительно океана/моря

Целевая переменная:

- ***medianHouseValue:*** средняя стоимость жилья для домохозяйств в пределах квартала (измеряется в долларах США)

## Технологии

- **Python 3.11+**
- **Scikit-learn**, **Pandas**, **NumPy**, **Matplotlib**, **Seaborn**
- **Streamlit** — веб-интерфейс для пользователя
- **FastAPI + Uvicorn** — REST API для инференса
- **Joblib** — сохранение обученных моделей
- **pydantic** - валидация данных и настройки для FastAPI
- **requests** - HTTP-запросы для взаимодействия с API

## Основные этапы 

✅Анализ и предобработка данных: удаление пропущенных значений, ограничение и удаление выбросов

✅Создание новых признаков и One-Hot Encoding для ocean_proximity

✅Анализ корреляций признаков

✅Обучение ансамблевых моделей с кросс-валидацией: Random Forest Regressor и Gradient Boosting Regressor

✅Подбор гиперпараметров с помощью RandomizedSearchCV и оценка метрик(R^2 и RMSE)

Для удобства взаимодействия созданы:
- **Streamlit**-приложение для визуализации и интерактивных предсказаний
- **FastAPI**-сервис для программного вызова модели через HTTP

## Результаты 

| | RMSE | R² Score |
|:---:|:---:|:---:|
| Random Forest Regressor | 44021.74 | 0.8101 |
| Gradient Boosting Regressor | **43247.14** | **0.8167** |

 **Gradient Boosting** показал чуть лучшие метрики, чем **Random Forest**: на ~774 меньшую RMSE и на 0,66% лучшую объясняющую способность. 
 
Ограничения: модель не учитывает инфляцию, рыночные циклы, состояние дома.

## Лицензия

Этот проект распространяется под лицензией MIT. Подробнее см. в файле LICENSE.
  

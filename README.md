# California Housing Prices

Модель машинного обучения(Gradient Boosting), помогающая риелторам, инвесторам и банкам в оценке недвижимости в штате Калифорния. 
Проект включает визуализацию данных, обучение модели и создание веб-интерфейса с помощью FastAPI и Streamlit для взаимодействия c данными.

## Локальный запуск

1. Клонируйте репозиторий:

```bash
git clone https://github.com/BRSHD/house-pricing
```

2. Создайте виртуальное окружение для проекта с помощью `venv`:

```shell
python -m venv venv
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate.ps1  # Windows
```

3. Установите зависимости проекта:

```shell
pip install -r requirements.txt
```

4. Запустите сервис с помощью команды:

```shell
uvicorn service:app
```

5. После запуска сервиса выполните команду для показа веб-интерфейса:

```shell
streamlit run app.py
```


## Данные

Открытый датасет [**California Housing Prices**](https://www.kaggle.com/datasets/camnugent/california-housing-prices).  

Размер: 20640 строк

Признаки:
- longitude: показатель того, насколько далеко на запад находится дом; чем больше значение, тем дальше на запад

- latitude: показатель того, насколько далеко на север находится дом; чем больше значение, тем дальше на север

- housingMedianAge: средний возраст дома в квартале; меньшее число соответствует более новому зданию

- totalRooms: Общее количество комнат в квартале

- totalBedrooms: Общее количество спален в квартале

- population: Общее количество людей, проживающих в пределах квартала

- households: общее количество домохозяйств, группы людей, проживающих в пределах жилого помещения, для квартала

- medianIncome: средний доход домохозяйств в пределах жилого квартала (измеряется в десятках тысяч долларов США)

- oceanProximity: Расположение дома относительно океана/моря

Целевая переменная:

- medianHouseValue: средняя стоимость жилья для домохозяйств в пределах квартала (измеряется в долларах США)

## Технологии

- **Python 3.11+**
- **Scikit-learn**, **Pandas**, **NumPy**, **Matplotlib**, **Seaborn**
- **Streamlit** — веб-интерфейс для пользователя
- **FastAPI + Uvicorn** — REST API для инференса
- **Joblib** — сохранение обученных моделей
- **pydantic** - валидация данных и настройки для FastAPI
- **requests** - HTTP-запросы для взаимодействия с API

## Основные этапы 
✅Анализ и предобработка данных: удаление пропущенных значений и ограничение выбросов

✅Создание новых признаков и One-Hot Encoding для ocean_proximity

✅Анализ корреляций признаков

✅Построение моделей с кросс-валидацией: Random Forest Regressor и Gradient Boosting Regressor

✅Подбор гиперпараметров с помощью RandomizedSearchCV и оценка метрик(R^2 и RMSE)

Для удобства взаимодействия созданы:
- **Streamlit** - приложение для визуализации и интерактивных предсказаний
- **FastAPI** - сервис для программного вызова модели через HTTP

## Результаты 

| | RMSE | R² Score | 
|----------|------|----------|
| Random Forest Regressor | 53737.02 | 0.7792 |
| Gradient Boosting Regressor | **52847.56** | **0.7864** | 

 **Gradient Boosting** показал чуть лучшие метрики, чем **Random Forest**: на ~890 меньшую RMSE и на 0,72% лучшую объясняющую способность. 

## Лицензия

Этот проект распространяется под лицензией MIT. Подробнее см. в файле LICENSE.
  
